# フロントエンド実装計画書: Discoverページ

## 📋 概要
画像で示されたDiscoverページの実装。ユーザーが他のユーザーのプロフィールカードを閲覧し、いいね・スキップのインタラクションを行う機能。

## 🎯 実装された機能

### ページレイアウト
- **ヘッダー**: Qupidロゴ、大きな「探す」テキスト、赤い検索ボタン
- **背景**: 白背景（シンプルなデザイン）
- **カード表示**: 縦長グリッドレイアウト（2列で縦にスクロール可能、すべてのユーザーを表示）

### ユーザーカード機能
- **プロフィール情報表示**: 名前のみ表示（シンプルなデザイン）
- **プロフィール画像**: アバター画像またはグレーのシルエットアイコン
- **インタラクション**: スキップ（×）といいね（♥）ボタン（カード下部中央に配置）
- **アニメーション**: ボタン押下時のアニメーション効果
- **カード形状**: 正方形（aspect-square）

### ナビゲーション
- **メインナビ**: "ホーム" → "Discover" に変更
- **アイコン**: 🏠 → 💖 に変更

## 🧱 実装されたコンポーネント

### DiscoverPage (`/app/(dashboard)/home/page.tsx`)
- メインのDiscoverページコンポーネント
- ユーザー一覧の管理と表示
- いいね・スキップ処理
- フィルター機能の統合
- トースト通知の統合

### DiscoverUserCard (`/components/features/DiscoverUserCard.tsx`)
- ユーザープロフィールカードの表示（従来の1枚表示用）
- インタラクションボタンの実装
- アニメーション効果
- レスポンシブデザイン

### DiscoverUserGridCard (`/components/features/DiscoverUserGridCard.tsx`)
- グリッド表示用のユーザープロフィールカード
- 正方形のカードデザイン
- シルエットアイコンの表示
- シンプルな名前表示
- カード下部中央にX/ハートボタン配置

### DiscoverFilters (`/components/features/DiscoverFilters.tsx`)
- フィルター設定UIの実装
- セクシュアリティ、性別、関係性目標、ジェンダー範囲の設定
- モーダル形式での表示
- Clear/Continue機能

### ToastContainer (`/components/common/ToastContainer.tsx`)
- いいね・マッチ通知の表示
- 自動削除機能
- 複数トーストの管理

### useToast Hook (`/hooks/useToast.ts`)
- トースト通知の状態管理
- タイプ別の通知（success, error, warning, info）
- 自動削除機能

## 🔌 API統合

### 使用API
- `GET /users/suggestions` - おすすめユーザー取得（フィルター対応）
- `POST /likes` - いいね送信
- `GET /likes/sent`, `/likes/received` - いいね履歴
- `GET /matches`, `/matches/{user_id}` - マッチ一覧・状態確認
- `DELETE /likes/{user_id}` - いいね取り消し

### フィルターパラメータ
- `sexuality` - セクシュアリティフィルター（カンマ区切り）
- `relationship_goal` - 関係性目標フィルター
- `sex` - 性別フィルター（カンマ区切り）
- `gender_min/gender_max` - ジェンダー範囲フィルター
- `age_min/age_max` - 年齢範囲フィルター

### データフロー
1. ページ読み込み時にユーザー一覧を取得（20人）
2. フィルター設定時にAPI呼び出し（フィルター適用）
3. グリッド表示で最大4人のユーザー情報を表示
4. いいね・スキップ時にAPI呼び出し
5. レスポンスに基づいてトースト通知
6. 処理済みユーザーを管理し、新しいユーザーを自動表示
7. 表示可能なユーザーが4人以下になったら自動的に再取得

## 🎨 デザイン仕様

### カラーパレット
- **背景**: 白背景（シンプルなデザイン）
- **カード**: 白ベース、角丸デザイン（rounded-xl）
- **ボタン**: 白背景の円形ボタン（X/ハートアイコン）
- **テキスト**: 白（カード内の名前）、黒（ヘッダー）
- **シルエット**: グレー（neutral-200/300）

### レイアウト
- **カードサイズ**: 正方形（aspect-square）
- **グリッド**: 2列の縦長グリッドレイアウト（縦にスクロール可能）
- **ボタン配置**: カード下部中央に2つのボタン（Xとハート）
- **情報配置**: カード下部に名前を中央配置
- **レスポンシブ**: モバイルファーストデザイン、最大幅2xlで中央配置
- **スクロール**: 縦方向にスクロールしてすべてのユーザーを閲覧可能

### ヘッダーデザイン
- **左側**: Qupidロゴ（画像+テキスト）+ 大きな「探す」テキスト
- **右側**: 赤い四角の検索ボタン（primary-500）

## 🔄 ユーザー体験フロー

1. **ページアクセス**: Discoverページに遷移
2. **フィルター設定**: 検索アイコンをタップしてフィルター画面を表示
3. **フィルター選択**: セクシュアリティ、性別、関係性目標、ジェンダー範囲を設定
4. **フィルター適用**: Continueボタンでフィルターを適用
5. **ユーザー表示**: フィルターされたおすすめユーザーを縦長グリッド（2列）で表示（すべてのユーザーを縦にスクロール可能）
6. **インタラクション**: 各カードのいいね・スキップボタンクリック
7. **フィードバック**: アニメーションとトースト通知
8. **自動更新**: 処理済みユーザーを非表示にし、新しいユーザーを自動表示
9. **再取得**: 表示可能なユーザーが8人以下になったら自動的に再取得
10. **完了時**: すべて見た場合の特別な画面表示

## 📱 レスポンシブ対応

### モバイル
- カードは画面幅に合わせて調整
- ボタンはタッチしやすいサイズ
- ヘッダーは固定表示

### デスクトップ
- カードは中央配置
- ホバー効果の追加
- より大きなカードサイズ

## 🧪 テスト項目

### 機能テスト
- [x] ユーザー一覧の取得と表示
- [x] フィルター機能の動作
- [x] セクシュアリティフィルターの選択
- [x] 性別フィルターの選択
- [x] 関係性目標フィルターの選択
- [x] ジェンダー範囲フィルターの設定
- [x] フィルターのクリア機能
- [x] いいね送信の成功・失敗処理
- [x] スキップ機能の動作
- [x] マッチ時の通知表示
- [x] 次のユーザーへの遷移
- [x] すべて見た場合の表示

### UI/UXテスト
- [x] カードのアニメーション効果
- [x] ボタンのホバー・アクティブ状態
- [x] フィルターモーダルの表示・非表示
- [x] フィルター設定のUI操作
- [x] トースト通知の表示・削除
- [x] レスポンシブレイアウト
- [x] ローディング状態の表示

## 🔒 セキュリティ・考慮事項

### データ保護
- ユーザー情報の適切な表示
- APIキーの保護
- エラーハンドリング

### パフォーマンス
- 画像の遅延読み込み
- カードの仮想化（将来実装）
- API呼び出しの最適化

## 📈 成功指標

- [x] Discoverページの正常表示
- [x] ユーザーカードの適切な表示
- [x] フィルター機能の完全実装
- [x] フィルター適用後のユーザー表示
- [x] いいね・スキップ機能の動作
- [x] マッチ通知の表示
- [x] レスポンシブデザインの実装

## 🔄 今後の拡張予定

### 機能拡張
- スワイプジェスチャーの追加
- プロフィール画像の表示
- スーパーライク機能
- 年齢範囲フィルターの追加
- フィルターの保存機能

### パフォーマンス改善
- 無限スクロールの実装
- 画像の最適化
- キャッシュ戦略の改善

## 📝 変更履歴

### 2025-12-07: グリッドレイアウトへの変更
- 1枚ずつのカード表示から縦長グリッドレイアウト（2列）に変更
- ヘッダーデザインを画像に合わせて再設計（Qupidロゴ、大きな「探す」テキスト、赤い検索ボタン）
- カードデザインを正方形に変更し、シンプルなデザインに統一
- 処理済みユーザー管理機能を追加（Setを使用）
- DiscoverUserGridCardコンポーネントを新規作成
- 縦方向にスクロール可能なレイアウトに変更（すべてのユーザーを表示）

---

**作成日**: 2025-01-27  
**更新日**: 2025-12-07  
**担当者**: Qupid開発チーム
